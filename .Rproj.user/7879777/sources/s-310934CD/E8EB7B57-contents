
require(dplyr)

freq2 <- function(data, var){
  
  var <- rlang::sym(var)
  
  table <- 
    data %>% 
    count(!! var) %>% 
    mutate(`%` = round(n/sum(n, na.rm = TRUE) * 100, 2)) %>% 
    rename(Categoria = !! var, N = n)
  
  tibble(`Variável` = quo_name(quo(!! var))) %>% 
    bind_rows(tibble(`Variável` = rep(NA, nrow(table) -1))) %>% 
    bind_cols(table) %>% 
    mutate(`Variável` = ifelse(is.na(`Variável`), "", `Variável`))
  
}
